namespace = incident_EDG_Imperial_tax_event
normal_or_historical_nations = yes
country_event = {#皇帝要求征收帝国税
  id = incident_EDG_Imperial_tax_event.2
  title = "incident_EDG_Imperial_tax_event.2.t"
  desc = "incident_EDG_Imperial_tax_event.2.d"
  picture = HRE_eventPicture
  #major = yes
  #fire_only_once = yes
  is_triggered_only = yes
  trigger = { 
  }
  mean_time_to_happen = {
  }
  immediate = {
		hidden_effect = {
			export_to_variable = {
				which = money_to_transfer
				value = years_of_income
				who = ROOT
			}
			multiply_variable = {
				which = money_to_transfer
				value = 0.1
			}
      change_variable = {
        which = money_to_transfer
        value = 1
      }
			set_variable = {
				which = money_to_transfer_info
				which = money_to_transfer
			}
		}
  }
  option = {#这是我们的义务。
    name = "incident_EDG_Imperial_tax_event.2.a"
    ai_chance = {
      factor = 10
      modifier = {
        factor = 3
        has_global_flag = EDG_HAB_mission_1_22_tt_flag
        capital_scope = { region = italy_region }
      }
      modifier = {
        factor = 0
        OR = {
          is_rival = emperor
          is_enemy = emperor
          is_league_enemy = emperor
        }
      }
      modifier = {
        factor = 1.2
        has_opinion = {
          who = emperor
          value = 10
        }
      }
      modifier = {
        factor = 1.5
        has_opinion = {
          who = emperor
          value = 50
        }
      }
      modifier = {
        factor = 1.5
        has_opinion = {
          who = emperor
          value = 100
        }
      }
      modifier = {
        factor = 3
        has_opinion = {
          who = emperor
          value = 150
        }
      }
      modifier = {
        factor = 3
        has_opinion = {
          who = emperor
          value = 180
        }
      }
      modifier = {
        factor = 10
        alliance_with = emperor
      }
      modifier = {
        factor = 50
        is_league_friend = emperor
      }
      modifier = {
        factor = 1.5
        emperor = {
          diplomatic_reputation = 2
        }
      }
      modifier = {
        factor = 1.5
        emperor = {
          diplomatic_reputation = 4
        }
      }
      modifier = {
        factor = 2
        emperor = {
          diplomatic_reputation = 6
        }
      }
      modifier = {
        factor = 2
        emperor = {
          diplomatic_reputation = 8
        }
      }
      modifier = {
        factor = 3
        emperor = {
          diplomatic_reputation = 10
        }
      }
      modifier = {
        factor = 2
        emperor = {
          NOT = { army_size = 10 }
        }
        NOT = {
          military_strength = {
            who = emperor
            value = 1.0
          }
        }
      }
    }
    custom_tooltip = incident_EDG_Imperial_tax_event_2_a_tt
    incident_EDG_Imperial_good_prince_effect = yes
    emperor = {
      add_trust = {
        who = ROOT
        value = 5
        #mutual = yes
      }
    }
    transfer_treasury = {
      custom_tooltip = flavor_rus.295.a.tt
      giver = ROOT
      taker = FROM
      variable = money_to_transfer
    }
    set_country_flag = EDG_bulgaria_tax_taxed_country_flag

    hidden_effect = {
      if = {
        limit = {
          NOT = { ruler_has_personality = babbling_buffoon_personality }  
          NOT = { ruler_has_personality = drunkard_personality }
          NOT = { ruler_has_personality = cruel_personality }
          NOT = { ruler_has_personality = greedy_personality }
        }
        random_list = {
          1 = {
            emperor = {
              country_event = { id = EDG_flavorHRE.3 }
            }
          }
          99 = {
          }
        }
      }
    }
  }

  option = {#我们不敢违背皇帝。
    name = "incident_EDG_Imperial_tax_event.2.b"
    ai_chance = {
      factor = 10
      modifier = {
        factor = 0
        OR = {
          is_rival = emperor
          is_enemy = emperor
          is_league_enemy = emperor
        }
      }
      modifier = {
        factor = 1.2
        has_opinion = {
          who = emperor
          value = 10
        }
      }
      modifier = {
        factor = 1.5
        has_opinion = {
          who = emperor
          value = 50
        }
      }
      modifier = {
        factor = 1.5
        has_opinion = {
          who = emperor
          value = 100
        }
      }
      modifier = {
        factor = 1.5
        has_opinion = {
          who = emperor
          value = 150
        }
      }
      modifier = {
        factor = 3
        has_opinion = {
          who = emperor
          value = 180
        }
      }
      modifier = {
        factor = 5
        alliance_with = emperor
      }
      modifier = {
        factor = 5
        is_league_friend = emperor
      }
      modifier = {
        factor = 1.5
        emperor = {
          diplomatic_reputation = 2
        }
      }
      modifier = {
        factor = 1.5
        emperor = {
          diplomatic_reputation = 4
        }
      }
      modifier = {
        factor = 1.5
        emperor = {
          diplomatic_reputation = 6
        }
      }
      modifier = {
        factor = 1.5
        emperor = {
          diplomatic_reputation = 8
        }
      }
      modifier = {
        factor = 1.5
        emperor = {
          diplomatic_reputation = 10
        }
      }
      modifier = {
        factor = 2
        emperor = {
          NOT = { army_size = 10 }
        }
        NOT = {
          military_strength = {
            who = emperor
            value = 1.0
          }
        }
      }
    }
    custom_tooltip = incident_EDG_Imperial_tax_event_2_a_tt
    incident_EDG_Imperial_good_prince_effect = yes
    add_opinion = {
      who = emperor
      modifier = opinion_EDG_HRE_Require_to_fulfill_obligations
    }
    
		transfer_treasury = {
			custom_tooltip = flavor_rus.295.a.tt
			giver = ROOT
			taker = FROM
			variable = money_to_transfer
		}
    set_country_flag = EDG_bulgaria_tax_taxed_country_flag


  }

  option = {#可是我们没有钱。
    name = "incident_EDG_Imperial_tax_event.2.c"
    ai_chance = {
      factor = 10
			modifier = {
			  factor = 2
			  is_at_war = yes
			}
			modifier = {
			  factor = 2
			  is_in_deficit = yes
			}
			modifier = {
			  factor = 2
			  num_of_loans = 5
			}
      modifier = {
        factor = 2
        NOT = {
          has_opinion = {
            who = emperor
            value = -20
          }
        }
      }
      modifier = {
        factor = 15
        NOT = {
          has_opinion = {
            who = emperor
            value = -50
          }
        }
      }
      modifier = {
        factor = 50
        NOT = {
          has_opinion = {
            who = emperor
            value = -100
          }
        }
      }
      modifier = {
        factor = 0
        is_subject_of = emperor
      }
      modifier = {
        factor = 0.75
        emperor = {
          prestige = 50
        }
      }
      modifier = {
        factor = 1.25
        emperor = {
          NOT = { army_size = 10 }
        }
        military_strength = {
          who = emperor
          value = 5.0
        }
      }
      modifier = {
        factor = 10
        is_in_deficit = yes
      }
      modifier = {
        factor = 10
        is_at_war = yes
      }
      modifier = {
        factor = 1000
        is_bankrupt = yes
      }
    }
    incident_EDG_Imperial_crap_prince_effect = yes
    hidden_effect = {
      if = {
        limit = {
          OR = {
            ruler_has_personality = babbling_buffoon_personality
            ruler_has_personality = drunkard_personality
          }
        }
        random_list = {
          1 = {
            emperor = {
              country_event = { id = EDG_flavorHRE.2 }
            }
          }
          99 = {  }
        }
      }
    }
  }

  option = {#我们是免税诸侯。
    name = "incident_EDG_Imperial_tax_event.2.e"
    ai_chance = {
      factor = 1000
    }
    trigger = {
      has_country_flag = EDG_HRE_tax_duty_free_princes_flag
    }
    custom_tooltip = EDG_HRE_tax_duty_free_princes_tt
    add_opinion = {
      who = emperor
      modifier = opinion_EDG_HRE_relief_from_obligation
    }

    
  }
  after = {
    set_country_flag = EDG_bulgaria_tax_taxing_country_flag
  }
}





country_event = {#皇帝要求征召帝国军
  id = incident_EDG_Imperial_tax_event.3
  title = "incident_EDG_Imperial_tax_event.3.t"
  desc = "incident_EDG_Imperial_tax_event.3.d"
  picture = HRE_eventPicture
  #major = yes
  #fire_only_once = yes
  is_triggered_only = yes
  trigger = { 
  }
  mean_time_to_happen = {
  }
  immediate = {
  }
  option = {#这是我们的义务。
    name = "incident_EDG_Imperial_tax_event.2.a"
    ai_chance = {
      factor = 10
      modifier = {
        factor = 0
        OR = {
          is_rival = emperor
          is_enemy = emperor
          is_league_enemy = emperor
        }
      }
      modifier = {
        factor = 1.2
        has_opinion = {
          who = emperor
          value = 10
        }
      }
      modifier = {
        factor = 1.5
        has_opinion = {
          who = emperor
          value = 50
        }
      }
      modifier = {
        factor = 1.5
        has_opinion = {
          who = emperor
          value = 100
        }
      }
      modifier = {
        factor = 3
        has_opinion = {
          who = emperor
          value = 150
        }
      }
      modifier = {
        factor = 3
        has_opinion = {
          who = emperor
          value = 180
        }
      }
      modifier = {
        factor = 10
        alliance_with = emperor
      }
      modifier = {
        factor = 50
        is_league_friend = emperor
      }
      modifier = {
        factor = 1.5
        emperor = {
          diplomatic_reputation = 2
        }
      }
      modifier = {
        factor = 1.5
        emperor = {
          diplomatic_reputation = 4
        }
      }
      modifier = {
        factor = 2
        emperor = {
          diplomatic_reputation = 6
        }
      }
      modifier = {
        factor = 2
        emperor = {
          diplomatic_reputation = 8
        }
      }
      modifier = {
        factor = 3
        emperor = {
          diplomatic_reputation = 10
        }
      }
      modifier = {
        factor = 2
        emperor = {
          NOT = { army_size = 10 }
        }
        NOT = {
          military_strength = {
            who = emperor
            value = 1.0
          }
        }
      }
    }
    custom_tooltip = incident_EDG_Imperial_manpower_event_2_a_tt
    incident_EDG_Imperial_good_prince_effect = yes
    emperor = {
      add_trust = {
        who = ROOT
        value = 5
        #mutual = yes
      }
    }
    add_mil_power = -100
		hidden_effect = {
			every_owned_province = {
        limit = { is_part_of_hre = yes }
        add_manpower = -0.1
        emperor = { add_manpower = 0.1 }
      }
		}
  }

  option = {#我们不敢违背皇帝。
    name = "incident_EDG_Imperial_tax_event.2.b"
    ai_chance = {
      factor = 10
      modifier = {
        factor = 0
        OR = {
          is_rival = emperor
          is_enemy = emperor
          is_league_enemy = emperor
        }
      }
      modifier = {
        factor = 1.2
        has_opinion = {
          who = emperor
          value = 10
        }
      }
      modifier = {
        factor = 1.5
        has_opinion = {
          who = emperor
          value = 50
        }
      }
      modifier = {
        factor = 1.5
        has_opinion = {
          who = emperor
          value = 100
        }
      }
      modifier = {
        factor = 1.5
        has_opinion = {
          who = emperor
          value = 150
        }
      }
      modifier = {
        factor = 3
        has_opinion = {
          who = emperor
          value = 180
        }
      }
      modifier = {
        factor = 5
        alliance_with = emperor
      }
      modifier = {
        factor = 5
        is_league_friend = emperor
      }
      modifier = {
        factor = 1.5
        emperor = {
          diplomatic_reputation = 2
        }
      }
      modifier = {
        factor = 1.5
        emperor = {
          diplomatic_reputation = 4
        }
      }
      modifier = {
        factor = 1.5
        emperor = {
          diplomatic_reputation = 6
        }
      }
      modifier = {
        factor = 1.5
        emperor = {
          diplomatic_reputation = 8
        }
      }
      modifier = {
        factor = 1.5
        emperor = {
          diplomatic_reputation = 10
        }
      }
      modifier = {
        factor = 2
        emperor = {
          NOT = { army_size = 10 }
        }
        NOT = {
          military_strength = {
            who = emperor
            value = 1.0
          }
        }
      }
    }
    custom_tooltip = incident_EDG_Imperial_manpower_event_2_a_tt
    incident_EDG_Imperial_good_prince_effect = yes
    add_opinion = {
      who = emperor
      modifier = opinion_EDG_HRE_Require_to_fulfill_obligations
    }
		hidden_effect = {
			every_owned_province = {
        limit = { is_part_of_hre = yes }
        add_manpower = -0.1
        emperor = { add_manpower = 0.1 }
      }
		}


  }

  option = {#我们拒绝这项暴政。
    name = "incident_EDG_Imperial_tax_event.3.c"
    ai_chance = {
      factor = 10
			modifier = {
			  factor = 2
			  is_at_war = yes
			}
			modifier = {
			  factor = 2
			  is_in_deficit = yes
			}
			modifier = {
			  factor = 2
			  num_of_loans = 5
			}
      modifier = {
        factor = 2
        NOT = {
          has_opinion = {
            who = emperor
            value = -20
          }
        }
      }
      modifier = {
        factor = 15
        NOT = {
          has_opinion = {
            who = emperor
            value = -50
          }
        }
      }
      modifier = {
        factor = 50
        NOT = {
          has_opinion = {
            who = emperor
            value = -100
          }
        }
      }
      modifier = {
        factor = 0
        is_subject_of = emperor
      }
      modifier = {
        factor = 0.75
        emperor = {
          prestige = 50
        }
      }
      modifier = {
        factor = 1.25
        emperor = {
          NOT = { army_size = 10 }
        }
        military_strength = {
          who = emperor
          value = 5.0
        }
      }
      modifier = {
        factor = 10
        is_in_deficit = yes
      }
      modifier = {
        factor = 10
        is_at_war = yes
      }
      modifier = {
        factor = 1000
        is_bankrupt = yes
      }
    }
    incident_EDG_Imperial_crap_prince_effect = yes
    hidden_effect = {
      if = {
        limit = {
          OR = {
            ruler_has_personality = babbling_buffoon_personality
            ruler_has_personality = drunkard_personality
          }
        }
        random_list = {
          1 = {
            emperor = {
              country_event = { id = EDG_flavorHRE.2 }
            }
          }
          
          99 = {  }
        }
      }
    }
  }

  option = {#我们有相关特权。
    name = "incident_EDG_Imperial_tax_event.3.e"
    ai_chance = {
      factor = 1000
    }
    trigger = {
      OR = {
        has_country_flag = EDG_HRE_manpower_duty_free_princes_flag
        has_government_attribute = EDG_HRE_manpower_duty_free_princes_ability
      }
    }
    custom_tooltip = EDG_HRE_manpower_duty_free_princes_tt
    add_opinion = {
      who = emperor
      modifier = opinion_EDG_HRE_relief_from_obligation
    }

    
  }
}
