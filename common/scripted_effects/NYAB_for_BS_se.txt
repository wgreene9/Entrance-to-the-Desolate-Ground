NYAB_KAZ_levelup_zhanchi_modifier_effect = {
	if = {
		limit = {
			has_province_modifier = NYAB_KAZ_zhanchi_modifier_prov4
		}
		add_province_modifier = {
			name = NYAB_KAZ_zhanchi_modifier_prov5
			duration = -1
		}
	}
	else_if = {
		limit = {
			has_province_modifier = NYAB_KAZ_zhanchi_modifier_prov3
		}
		add_province_modifier = {
			name = NYAB_KAZ_zhanchi_modifier_prov4
			duration = -1
		}
	}
	else_if = {
		limit = {
			has_province_modifier = NYAB_KAZ_zhanchi_modifier_prov2
		}
		add_province_modifier = {
			name = NYAB_KAZ_zhanchi_modifier_prov3
			duration = -1
		}
	}
	else_if = {
		limit = {
			has_province_modifier = NYAB_KAZ_zhanchi_modifier_prov1
		}
		add_province_modifier = {
			name = NYAB_KAZ_zhanchi_modifier_prov2
			duration = -1
		}
	}
	else = {
		add_province_modifier = {
			name = NYAB_KAZ_zhanchi_modifier_prov1
			duration = -1
		}
	}
}
NYAB_BJR_buzu_tendency_effect = {
	[[add]
		custom_tooltip = NYAB_BJR_buzu_tendency_effect_add
		hidden_effect = {
			change_variable = {
				which = NYAB_BJR_buzu_tendency_var
				value = $add$
			}
		}
	]
	[[reduce]
		custom_tooltip = NYAB_BJR_buzu_tendency_effect_reduce
		hidden_effect = {
			subtract_variable = {
				which = NYAB_BJR_buzu_tendency_var
				value = $reduce$
			}
		}
	]
}
NYAB_BJR_sword_of_islam_update_effect = {
	custom_tooltip = NYAB_BJR_sword_of_islam_update_effect_tt
	if = {
		limit = { 
			has_country_flag = NYAB_BJR_sword_of_islam_update_flag4
		}
		set_country_flag = NYAB_BJR_sword_of_islam_update_flag5
	}
	else_if = {
		limit = { 
			has_country_flag = NYAB_BJR_sword_of_islam_update_flag3
		}
		set_country_flag = NYAB_BJR_sword_of_islam_update_flag4
	}
	else_if = {
		limit = { 
			has_country_flag = NYAB_BJR_sword_of_islam_update_flag2
		}
		set_country_flag = NYAB_BJR_sword_of_islam_update_flag3
	}
	else_if = {
		limit = {
			has_country_flag = NYAB_BJR_sword_of_islam_update_flag1
		}
		set_country_flag = NYAB_BJR_sword_of_islam_update_flag2
	}
	else = {
		set_country_flag = NYAB_BJR_sword_of_islam_update_flag1
	}
}
NYAB_BJR_sword_of_islam_show_effect = {
	#1级，解锁cb对东欧地区异教国家 75%ae 100%分数
	#2级，对所有相邻异教，-10%分数 75%ae 90%分数
	#3级，不接壤也能用，-10%ae 65%ae 90%分数
	#4级，-15%ae，-15%分数 50%ae 75%分数 
	#5级，对所有国家使用
	custom_tooltip = NYAB_BJR_sword_of_islam_show_tt
	if = {
		limit = {
			has_country_flag = NYAB_BJR_sword_of_islam_update_flag1
		}
		custom_tooltip = NYAB_BJR_sword_of_islam_show_ttyes1
	}
	else = {
		custom_tooltip = NYAB_BJR_sword_of_islam_show_ttno1
	}
	if = {
		limit = {
			has_country_flag = NYAB_BJR_sword_of_islam_update_flag2
		}
		custom_tooltip = NYAB_BJR_sword_of_islam_show_ttyes2
	}
	else = {
		custom_tooltip = NYAB_BJR_sword_of_islam_show_ttno2
	}
	if = {
		limit = {
			has_country_flag = NYAB_BJR_sword_of_islam_update_flag3
		}
		custom_tooltip = NYAB_BJR_sword_of_islam_show_ttyes3
	}
	else = {
		custom_tooltip = NYAB_BJR_sword_of_islam_show_ttno3
	}
	if = {
		limit = {
			has_country_flag = NYAB_BJR_sword_of_islam_update_flag4
		}
		custom_tooltip = NYAB_BJR_sword_of_islam_show_ttyes4
	}
	else = {
		custom_tooltip = NYAB_BJR_sword_of_islam_show_ttno4
	}
	if = {
		limit = {
			has_country_flag = NYAB_BJR_sword_of_islam_update_flag5
		}
		custom_tooltip = NYAB_BJR_sword_of_islam_show_ttyes5
	}
	else = {
		custom_tooltip = NYAB_BJR_sword_of_islam_show_ttno5
	}
}
#开始文化融合
NYAB_BJR_culture_integrate_start = {
	if = {
		limit = {
			NOT = {
				has_province_modifier = BJ_CP_show_value_modifier
			}
		}
		set_variable = {
			which = BJ_culture_progress_value
			value = 0
		}
		add_province_modifier = {
			name = BJ_CP_show_value_modifier
			duration = -1
		}
	}
	else = {
		NYAB_BJ_cultrue_progress_increase_effect = yes
	}
}
#改文化去萨卡里巴文化组
NYAB_BJR_change_to_saqaliba_effect = {
	if = {
		limit = {
			culture = ryazanian
		}
		change_culture = fadia
	}
	else_if = {
		limit = {
			culture = russian
		}
		set_province_flag = NYAB_was_mosike_flag
		change_culture = sakariba
	}
	else_if = {
		limit = {
			culture = byelorussian
		}
		change_culture = byesakariba
	}
	else_if = {
		limit = {
			OR = {
				culture = novgorodian
				culture = pomorian
			}
		}
		change_culture = shahr_bogaristan
	}
	else_if = {
		limit = { 
			culture_group = east_slavic
		}
		change_culture = sakariba
	}
	else_if = {
		limit = { 
			culture_group = west_slavic
		}
		change_culture = west_saqaliba
	}
	else_if = {
		limit = { 
			culture = kazani
		}
		change_culture = bogaristan
	}
	else_if = {
		limit = { 
			culture_group = tartar
		}
		change_culture = old_bogaristan
	}
	else = {
		change_culture = sakariba
	}
}
#修正计算
NYAB_BJ_CP_modifier_effect = {
	set_variable = {
		which = BJ_CP_modifier
		value = 0
	}
	clr_province_flag = BJ_has_owner_religion_flag
	clr_province_flag = BJ_has_owner_accepted_culture_flag
	#拥有者宗教
	if = {
		limit = {
			has_owner_religion = yes
		}
		set_province_flag = BJ_has_owner_religion_flag
		change_variable = {
			which = BJ_CP_modifier
			value = 0.25
		}
	}
	#可接受文化
	if = {
		limit = {
			has_owner_accepted_culture = yes
		}
		set_province_flag = BJ_has_owner_accepted_culture_flag
		change_variable = {
			which = BJ_CP_modifier
			value = 0.25
		}
	}
	#发展度
	set_variable = {
		which = BJ_CP_local_development
		value = 0
	}
	export_to_variable = {
		variable_name = BJ_CP_local_development
		value = trigger_value:development
	}
	multiply_variable = {
		which = BJ_CP_local_development
		value = -0.025
	}
	if = {
		limit = {
			NOT = {
				check_variable = {
					which = BJ_CP_local_development
					value = -0.5
				}
			}
		}
		set_variable = {
			which = BJ_CP_local_development
			value = -0.5
		}
	}
	change_variable = {
		which = BJ_CP_modifier
		which = BJ_CP_local_development
	}
	multiply_variable = {
		which = BJ_CP_local_development
		value = 100
	}
	#转文化花费
	set_variable = {
		which = BJ_culture_conversion_cost
		value = 0
	}
	set_variable = {
		which = BJ_local_culture_conversion_cost
		value = 0
	}
	export_to_variable = {
		which = BJ_culture_conversion_cost
		value = modifier:culture_conversion_cost
		who = owner
	}
	export_to_variable = {
		which = BJ_local_culture_conversion_cost
		value = modifier:local_culture_conversion_cost
	}
	change_variable = {
		which = BJ_culture_conversion_cost
		which = BJ_local_culture_conversion_cost
	}
	multiply_variable = {
		which = BJ_culture_conversion_cost
		value = -1
	}
	change_variable = {
		which = BJ_CP_modifier
		which = BJ_culture_conversion_cost
	}
	multiply_variable = {
		which = BJ_culture_conversion_cost
		value = 100
	}
}
#总值结果出炉
NYAB_BJ_cultrue_progress_increase_effect = {
	set_variable = {
		which = BJ_culture_increase
		value = 0
	}
	set_variable = {
		which = BJ_CP_base
		value = 3
	}
	change_variable = {
		which = BJ_culture_increase
		which = BJ_CP_base
	}
	NYAB_BJ_culture_integrate_base_effect = yes
	
	#每月加
	divide_variable = {
		which = BJ_culture_increase
		value = 12
	}
	change_variable = {
		which = BJ_culture_progress_value
		which = BJ_culture_increase
	}
	#输出时间
	set_variable = {
		which = BJ_CP_time_months
		value = 100
	}
	subtract_variable = {
		which = BJ_CP_time_months
		which = BJ_culture_progress_value
	}
	divide_variable = {
		which = BJ_CP_time_months
		which = BJ_culture_increase
	}
	divide_variable = {
		which = BJ_CP_time_months
		value = 12
	}
	multiply_variable = {
		which = BJ_CP_time_months
		value = 0.01
	}
	multiply_variable = {
		which = BJ_CP_time_months
		value = 100
	}
	if = {
		limit = {
			check_variable = {
				which = BJ_culture_progress_value
				value = 100
			}
		}
		NYAB_BJR_change_to_saqaliba_effect = yes
		remove_province_modifier = BJ_CP_show_value_modifier
	}
}
#数值计算
NYAB_BJ_culture_integrate_base_effect = {
	NYAB_BJ_CP_modifier_effect = yes
	set_variable = {
		which = BJ_CP_neighboring_provinces
		value = 0
	}
	every_neighbor_province = {
		limit = {
			is_city = yes
			culture_group = saqaliba_cg
		}
		PREV = {
			change_variable = {
				which = BJ_CP_neighboring_provinces
				value = 0.15
			}
		}
	}
	change_variable = {
		which = BJ_culture_increase
		which = BJ_CP_neighboring_provinces
	}
	if = {
		limit = {
			check_variable = {
				which = BJ_CP_modifier
				value = -1
			}
		}
		change_variable = {
			which = BJ_CP_modifier
			value = 1
		}
		multiply_variable = {
			which = BJ_culture_increase
			which = BJ_CP_modifier
		}
		subtract_variable = {
			which = BJ_CP_modifier
			value = 1
		}
	}
	else = {
		set_variable = {
			which = BJ_culture_increase
			value = 0
		}
	}
	multiply_variable = {
		which = BJ_CP_modifier
		value = 100
	}
}
#黄月亮逃难者效果
NYAB_BJR_shiite_settle_effect = {
	add_base_manpower = 2
	add_base_production = 2
	add_base_tax = 2
	change_religion = shiite
	add_core = ARL
	add_core = MSY
	add_province_triggered_modifier = NYAB_BJR_shiite_taonan_modifier
	hidden_effect = {
		ROOT = {
			country_event = {
				id = NYAB_KAZ.22
				days = 1825
				random = 365
			}
		}
	}
}

iceland_province_get = {
	custom_tooltip = iceland_province_get_tt
}

NYAB_remove_all_bad_terrain_modifier_effect = {
	if = {
		limit = {
			has_terrain = glacier
		}
		remove_province_modifier = NYAB_half_reduce_glacier_peanity_modifier
		add_province_modifier = {
			name = NYAB_remove_bad_develop_modifier_glacier
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			has_terrain = forest
		}
		add_province_modifier = {
			name = NYAB_remove_bad_develop_modifier_forest
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			has_terrain = hills 
		}
		add_province_modifier = {
			name = NYAB_remove_bad_develop_modifier_hills 
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			has_terrain = woods
		}
		add_province_modifier = {
			name = NYAB_remove_bad_develop_modifier_woods
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			has_terrain = mountain 
		}
		add_province_modifier = {
			name = NYAB_remove_bad_develop_modifier_mountain 
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			has_terrain = jungle 
		}
		add_province_modifier = {
			name = NYAB_remove_bad_develop_modifier_jungle 
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			has_terrain = desert
		}
		add_province_modifier = {
			name = NYAB_remove_bad_develop_modifier_desert
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			has_terrain = coastal_desert
		}
		add_province_modifier = {
			name = NYAB_remove_bad_develop_modifier_coastal_desert
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			has_terrain = coastline
		}
		add_province_modifier = {
			name = NYAB_remove_bad_develop_modifier_coastline
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			has_terrain = drylands
		}
		add_province_modifier = {
			name = NYAB_remove_bad_develop_modifier_drylands
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			has_terrain = highlands
		}
		add_province_modifier = {
			name = NYAB_remove_bad_develop_modifier_highlands
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			has_terrain = savannah
		}
		add_province_modifier = {
			name = NYAB_remove_bad_develop_modifier_savannah
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			has_terrain = steppe
		}
		add_province_modifier = {
			name = NYAB_remove_bad_develop_modifier_steppe
			duration = -1
			hidden = yes
		}
	}
}