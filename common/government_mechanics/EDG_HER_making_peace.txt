EDG_HER_making_peace = {
	available = {
		has_dlc = "King of Kings"
	}
	powers = {
		EDG_HER_making_peace_power = {
			gui = EDG_HER_making_peace_gui
			show_before_interactions = yes
			max = 100
			min = 0
			development_scaled_monthly_growth = -0.05
			reset_on_new_ruler = no
			scaled_modifier = {
				modifier = {
					global_tax_modifier = 0.1
					production_efficiency = 0.1
				}
			}
			scaled_modifier = {
				trigger = {
					has_country_flag = EDG_CWN_1_3_flag
				}
				modifier = {
					advisor_cost = -0.2
				}
			}
			scaled_modifier = {
				trigger = {
					has_country_flag = EDG_CWN_2_11_flag
				}
				modifier = {
					trade_efficiency = 0.1
				}
			}
			scaled_modifier = {
				trigger = {
					has_country_flag = EDG_CWN_3_2_flag
				}
				modifier = {
					promote_culture_cost = -0.1
				}
			}
			scaled_modifier = {
				trigger = {
					has_country_flag = EDG_CWN_3_8_flag
				}
				modifier = {
					yearly_corruption = -0.1
				}
			}
			scaled_modifier = {
				trigger = {
					has_country_flag = EDG_CWN_3_16_flag
				}
				modifier = {
					all_power_cost = -0.025
				}
			}
			scaled_modifier = {
				trigger = {
					has_reform = EDG_CWN_light_tower
				}
				modifier = {
					global_institution_spread = 0.1
				}
			}
			range_modifier = {
				trigger = {
					NOT = {
						prestige = 40
					}
					prestige = 20
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = 0.05
				}
			}
			range_modifier = {
				trigger = {
					NOT = {
						prestige = 60
					}
					prestige = 40
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = 0.1
				}
			}
			range_modifier = {
				trigger = {
					NOT = {
						prestige = 80
					}
					prestige = 60
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = 0.15
				}
			}
			range_modifier = {
				trigger = {
					NOT = {
						prestige = 100
					}
					prestige = 80
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = 0.2
				}
			}
			range_modifier = {
				trigger = {
					prestige = 100
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = 0.25
				}
			}
			range_modifier = {
				trigger = {
					NOT = {
						republican_tradition = 40
					}
					republican_tradition = 20
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = 0.05
				}
			}
			range_modifier = {
				trigger = {
					NOT = {
						republican_tradition = 60
					}
					republican_tradition = 40
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = 0.1
				}
			}
			range_modifier = {
				trigger = {
					NOT = {
						republican_tradition = 80
					}
					republican_tradition = 60
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = 0.15
				}
			}
			range_modifier = {
				trigger = {
					NOT = {
						republican_tradition = 100
					}
					republican_tradition = 80
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = 0.2
				}
			}
			range_modifier = {
				trigger = {
					republican_tradition = 100
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = 0.25
				}
			}
			range_modifier = {
				trigger = {
					stability = 3
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = 0.15
				}
			}
			range_modifier = {
				trigger = {
					NOT = {
						stability = 3
					}
					stability = 2
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = 0.1
				}
			}
			range_modifier = {
				trigger = {
					NOT = {
						stability = 2
					}
					stability = 1
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = 0.05
				}
			}
			range_modifier = {
				trigger = {
					NOT = {
						stability = 1
					}
					stability = 0
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = 0
				}
			}
			range_modifier = {
				trigger = {
					NOT = {
						stability = 0
					}
					stability = -1
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = -0.05
				}
			}
			range_modifier = {
				trigger = {
					NOT = {
						stability = -1
					}
					stability = -2
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = -0.1
				}
			}
			range_modifier = {
				trigger = {
					NOT = {
						stability = -2
					}
					stability = -3
				}
				modifier = {
					monthly_EDG_HER_making_peace_power = -0.15
				}
			}
		}
	}
	interactions = {
		EDG_HER_shequ = {
			icon = GFX_EDG_HER_shequ
			cost_type = EDG_HER_making_peace_power
			cost = 20
			trigger = {
			}
			effect = {
				custom_tooltip = EDG_CWN_2_1_A_TT				#获得1点不列颠世界影响力
				custom_tooltip = EDG_CWN_shequ_TT				#所有拥有移民社区的省份获得修正获得修正整合移民社区持续5年
				hidden_effect = {
					change_variable = {
						which = EDG_CWN_world_var						#不列颠世界影响力
						value = 1
					}
					every_owned_province = {
						limit = {
							OR = {
								has_province_modifier = EDG_HER_mission_8_modifier								#凯尔特社区
								has_province_modifier = EDG_CWN_france_modifier								#法兰西社区
								has_province_modifier = EDG_CWN_german_modifier								#日耳曼社区
								has_province_modifier = EDG_CWN_iberia_modifier								#伊比利亚社区
								has_province_modifier = EDG_CWN_latin_modifier								#拉丁社区
								has_province_modifier = EDG_CWN_little_modifier								#小社区
								has_province_modifier = EDG_CWN_big_modifier								#大社区
							}
						}
						add_province_modifier = {
							name = EDG_CWN_zhsq_modifier							#整合社区 （降自治）
							duration = 1825
						}
					}
					every_owned_province = {
						limit = {
							calc_true_if = {
								has_province_modifier = EDG_HER_mission_8_modifier								#凯尔特社区
								has_province_modifier = EDG_CWN_france_modifier								#法兰西社区
								has_province_modifier = EDG_CWN_german_modifier								#日耳曼社区
								has_province_modifier = EDG_CWN_iberia_modifier								#伊比利亚社区
								has_province_modifier = EDG_CWN_latin_modifier								#拉丁社区
								has_province_modifier = EDG_CWN_little_modifier								#小社区	
								amount = 3
							}
						}
						remove_province_modifier = EDG_HER_mission_8_modifier
						remove_province_modifier = EDG_CWN_france_modifier
						remove_province_modifier = EDG_CWN_german_modifier
						remove_province_modifier = EDG_CWN_iberia_modifier
						remove_province_modifier = EDG_CWN_iberia_modifier
						remove_province_modifier = EDG_CWN_little_modifier
						add_province_modifier = {
							name = EDG_CWN_big_modifier
							duration = -1
						}
					}
				}
				if = {
					limit = {
						NOT = {
							num_of_owned_provinces_with = {
								has_province_modifier = EDG_CWN_big_modifier
								value = 5
							}
						}
					}
					custom_tooltip = EDG_HER_shequ_1_tt					#通用描述
				}
				else_if = {
					limit = {
						num_of_owned_provinces_with = {
							has_province_modifier = EDG_CWN_big_modifier
							value = 5
						}
						NOT = {
							num_of_owned_provinces_with = {
								has_province_modifier = EDG_CWN_big_modifier
								value = 10
							}
						}
					}
					custom_tooltip = EDG_HER_shequ_2_tt					#通用描述
					hidden_effect = {
						country_event = {
							id = EDG_CWN_flavor_event.1							#移民到来
						}
					}
				}
				else_if = {
					limit = {
						num_of_owned_provinces_with = {
							has_province_modifier = EDG_CWN_big_modifier
							value = 10
						}
						NOT = {
							num_of_owned_provinces_with = {
								has_province_modifier = EDG_CWN_big_modifier
								value = 20
							}
						}
					}
					custom_tooltip = EDG_HER_shequ_3_tt					#通用描述
					hidden_effect = {
						country_event = {
							id = EDG_CWN_flavor_event.1							#移民到来
						}
						every_owned_province = {
							limit = {
								has_province_modifier = EDG_CWN_big_modifier
							}
							add_base_manpower = 1
						}
					}
				}
				else_if = {
					limit = {
						num_of_owned_provinces_with = {
							has_province_modifier = EDG_CWN_big_modifier
							value = 20
						}
					}
					custom_tooltip = EDG_HER_shequ_4_tt					#通用描述
					hidden_effect = {
						country_event = {
							id = EDG_CWN_flavor_event.1							#移民到来
						}
						every_owned_province = {
							limit = {
								has_province_modifier = EDG_CWN_big_modifier
							}
							add_base_manpower = 1
						}
						EDG_CWN_shequ_effect = yes						#获得1~5不列颠认同修正/50辉煌点数
					}
				}
				if = {
					limit = {
						has_reform = EDG_CWN_light_tower
					}
					custom_tooltip = EDG_CWN_LVUP_G_TT
					hidden_effect = {
						if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_1
							}
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
						else_if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_2
							}
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
						else_if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_3
							}
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
						else_if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_4
							}
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
						else_if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_5
							}
							add_splendor = 100
						}
						else = {
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
					}
				}
			}
		}
		EDG_HER_chengshihua = {
			icon = GFX_EDG_HER_chengshihua
			cost_type = EDG_HER_making_peace_power
			cost = 20
			trigger = {
				NOT = {
					has_country_modifier = kor_growing_economy
				}
			}
			effect = {
				add_country_modifier = {
					name = "kor_growing_economy"
					duration = 1825
				}
				custom_tooltip = ""
				custom_tooltip = EDG_HER_mission_2_2_tt				#获得一点城市治理经验，当前为§Y[Root.EDG_HER_CITY_EX_var.GetValue]§!。
				# custom_tooltip = EDG_CWN_chengshihua_tt				#获得一点城市群容量，当前为§Y[Root.EDG_CWN_csq_var.GetValue]§!。
				hidden_effect = {
					change_variable = {
						which = EDG_HER_CITY_EX_var
						value = 1
					}
					# change_variable = {
					# 	which = EDG_CWN_csq_var
					# 	value = 1
					# }
				}
				if = {
					limit = {
						NOT = {
							num_of_owned_provinces_with = {
								development = 30
								value = 5
							}
						}
					}
					custom_tooltip = EDG_HER_chengshi_1_tt					#通用描述
				}
				else_if = {
					limit = {
						num_of_owned_provinces_with = {
							development = 30
							value = 5
						}
						NOT = {
							num_of_owned_provinces_with = {
								development = 30
								value = 10
							}
						}
					}
					custom_tooltip = EDG_HER_chengshi_2_tt					#通用描述
					hidden_effect = {
						EDG_CWN_gangkoucheng_effect = yes
					}
				}
				else_if = {
					limit = {
						num_of_owned_provinces_with = {
							development = 30
							value = 10
						}
						NOT = {
							num_of_owned_provinces_with = {
								development = 30
								value = 20
							}
						}
					}
					custom_tooltip = EDG_HER_chengshi_3_tt					#通用描述
					hidden_effect = {
						EDG_CWN_gangkoucheng_effect = yes
						EDG_CWN_shengchanzhongxin_effect = yes
					}
				}
				else_if = {
					limit = {
						num_of_owned_provinces_with = {
							development = 30
							value = 20
						}
					}
					custom_tooltip = EDG_HER_chengshi_4_tt					#通用描述
					hidden_effect = {
						EDG_CWN_gangkoucheng_effect = yes
						EDG_CWN_shengchanzhongxin_effect = yes
						EDG_CWN_daxue_effect = yes
					}
				}
				if = {
					limit = {
						has_reform = EDG_CWN_light_tower
					}
					custom_tooltip = EDG_CWN_LVUP_G_TT
					hidden_effect = {
						if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_1
							}
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
						else_if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_2
							}
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
						else_if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_3
							}
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
						else_if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_4
							}
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
						else_if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_5
							}
							add_splendor = 100
						}
						else = {
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
					}
				}
			}
		}
		EDG_HER_qianghualianbangyihui = {
			icon = GFX_EDG_HER_qianghualianbangyihui
			cost_type = EDG_HER_making_peace_power
			cost = 20
			trigger = {
				if = {
					limit = {
						NOT = {
							has_country_modifier = EDG_CWN_3_V_modifier							#不列颠议会5级
						}
					}
					adm_power = 100
					innovativeness = 5
				}
			}
			effect = {
				if = {
					limit = {
						NOT = {
							has_country_modifier = EDG_CWN_3_V_modifier							#不列颠议会5级							
						}
					}
					add_adm_power = -100
					change_innovativeness = -5
					EDG_CWN_yihui_level_up = yes
				}
				else = {
					change_government_reform_progress = 30
					hidden_effect = {
						remove_country_modifier = EDG_CWN_3_IV_modifier
						remove_country_modifier = EDG_CWN_3_III_modifier
						remove_country_modifier = EDG_CWN_3_II_modifier
						remove_country_modifier = EDG_CWN_3_I_modifier
					}
				}
				if = {
					limit = {
						has_reform = EDG_CWN_light_tower
					}
					custom_tooltip = EDG_CWN_LVUP_G_TT
					hidden_effect = {
						if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_1
							}
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
						else_if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_2
							}
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
						else_if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_3
							}
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
						else_if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_4
							}
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
						else_if = {
							limit = {
								ruler_has_personality = EDG_personality_republican_knowledge_5
							}
							add_splendor = 100
						}
						else = {
							country_event = {
								id = EDG_HER_flavor_event.3
							}
						}
					}
				}
			}
		}
	}
}
