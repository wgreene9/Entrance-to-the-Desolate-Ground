


EDG_Transforming_into_EDG_PER_vassal_action = {#要求成为瓦利领
	category = influence
	require_acceptance = yes

	alert_index = 4
	alert_tooltip = EDG_Transforming_into_EDG_PER_vassal_action_tooltip

    require_acceptance = yes	   # 是否该行动需要被目标国家接受，以便执行接受效果
    
    # 决定何时该行动是可见的
	is_visible = {
		has_government_attribute = EDG_gain_per_influence_from_huge_same_culture_PER_vassal_ability
		FROM = {
			is_subject_of = ROOT
			OR = {
				is_subject_of_type = vassal
				is_subject_of_type = march
			}
		}
	}
    
    # 决定何时该行动能被采用
    
	is_allowed = {
		if = {
			limit = {
				FROM = { liberty_desire = 50 }
			}
			custom_trigger_tooltip = {
				tooltip = FROM_IS_REBELLIOUS_TT
				FROM = { liberty_desire = 50 }
			}
		}
		if = {
			limit = {
				FROM = { is_at_war = yes }
			}
			custom_trigger_tooltip = {
				tooltip = FROM_IS_AT_WAR_TT
				FROM = { is_at_war = no }
			}
		}
	}
	on_accept = {
		create_subject = { subject_type = EDG_PER_vassal subject = FROM }
		FROM = {
			set_country_flag = change_country_color_EDG_flag
			change_country_color = { country = ROOT }
		}
	}
    
    # 拒绝时（如果可拒绝）执行哪个效果。可选的。
    on_decline = {
       
    }
    
    # 控制AI对该行动的接受倾向，如果需要目标国家同意。非必须。
    ai_acceptance = {
        add_entry = {
            name = DIPLO_OPPINION
			export_to_variable = {
				variable_name = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			multiply_variable = {
				which = ai_value 
				value = 0.5
			}
        }
        add_entry = {
			name = TRUST
			export_to_variable = {
				variable_name = ai_value
				value = trust
				who = FROM
				with = ROOT
			}			
			subtract_variable = { 
				which = ai_value
				value = 50
			}
			#1 trust = +4 ai points
			multiply_variable = {
				which = ai_value
				value = 0.4
			}
		}
		add_entry = {
			name = AI_TOTAL_DEVELOPMENT
			export_to_variable = {
				variable_name = ai_value
				value = total_development
				who = FROM
			}
			#4 dev = -1
			multiply_variable = {
				which = ai_value
				value = 0.75
			}
		}
    }
    
    # 控制AI对该行动的使用
    ai_will_do = {
		all_country = {
			OR = {
				NOT = { is_subject_of = ROOT }
				NOT = { is_subject_of_type = EDG_PER_vassal }
			}
		}
    }
}
